# 2024FATI

### 순서
1. [WSL 설치](#wsl-설치)
2. [우분투 20.04 LTS 설치](#우분투-2004-lts-설치)
3. [DeepRacer 로컬 학습환경 구축](#DeepRacer 로컬 학습환경 구축)
<br>
---
<br>

## WSL 설치
1. **Windows PowerShell 관리자로 실행**
2. **Windows Subsystem for Linux 활성화**
    ```sh
    dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
    ```
3. **Virtual Machine feature 활성화**
    ```sh
    dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
    ```
<p align="center">
  <img width="790" alt="그림1" src="https://github.com/user-attachments/assets/001af36f-e848-4087-b074-5ba57c652315">
</p>

4. **컴퓨터 재부팅**
5. **x64용 리눅스 커널 업데이트 패키지 설치**  
    [https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi](https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi)  
6. **WSL를 WSL2로 업그레이드**  
    ```sh
    wsl --set-default-version 2
    ```
<br>

## 우분투 20.04 LTS 설치
1. **Microsoft Store에서 Ubuntu 20.04.6 LTS 다운로드**
<p align="center">
  <img src="https://github.com/user-attachments/assets/7c9734f5-0afc-4dcd-8bdc-527c8a5f26b2">
</p>]

2. **설치 된 Ubuntu 20.04 셸을 실행해서 ID, PW 설정**
3. **apt 명령어를 통한 시스템 최신화 및 업데이트**
    ```sh
    sudo apt update
    sudo apt upgrade
    ```
<br>

## DeepRacer 로컬 학습환경 구축
한줄씩 전부 명령어 실행하기
1. **필요 패키지 설치, docker-ce 설정**
    ```sh
    sudo apt-get install jq awscli python3-boto3 docker-compose
    ```

    ```sh
    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add –
    ```
<p align="center">
  <img src="https://github.com/user-attachments/assets/b02b3631-60e8-4d05-9e4a-6a73ea329fbc" alt="설치 단계 이미지">
</p>

<p align="center" style="color:red;">
  이미지처럼 GET이나 HIT 뜨면 문제 없음. E(error)나 FAIL 뜨면 실패
</p>

    ```sh
    sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
    ```
    
    <details>
      <summary style="color:red;">lsb_release: error: No arguments are permitted 에러 메시지와 해결방법</summary>
      <p><strong>에러 메시지:</strong></p>
      <p>lsb_release: error: No arguments are permitted<br>
      E: Malformed entry 50 in list file /etc/apt/sources.list (Component)<br>
      E: The list of sources could not be read.</p>

      <p><strong>해결방법 1:</strong></p>
      <p>우분투를 삭제했다가 다시 우분투 설치부터 다시 진행</p>

      <p><strong>해결방법 2:</strong></p>
      <p>sudo vi /etc/apt/sources.list<br>
      :50<br>
      dd<br>
      :wq<br>
      이 과정을 저 에러가 안 뜰 때까지 반복</p>
    </details>
    
    ```sh
    sudo apt-get update && sudo apt-get install -y --no-install-recommends docker-ce docker-ce-cli containerd.io
    ```

    ```sh
    curl https://get.docker.com | sh
    ```
<p align="center">
  <img src="https://github.com/user-attachments/assets/ab722f3d-66de-4488-b064-af25f522c54e">
</p>

<p align="center" style="color:red;">
  + sleep 나오고 멈춰도 기다리기 (1~2분동안 그대로이면 다시 실행)
</p>

2. **CUDA 11, Docker2 설치 (NVIDIA GPU 사용 시)**
    ```sh
    distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
    ```

    ```sh
    curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add –
    ```

    ```sh
    curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
    ```

    ```sh
    sudo apt-get update
    ```

    ```sh
    sudo apt-get install -y nvidia-docker2
    ```

    ```sh
    sudo service docker stop
    ```

    ```sh
    sudo service docker start
    ```

    ```sh
    cat /etc/docker/daemon.json | jq 'del(."default-runtime") + {"default-runtime": "nvidia"}' | sudo tee /etc/docker/daemon.json
    ```

    ```sh
    sudo usermod -a -G docker $(id -un)
    ```

3. **DRfC (DeepRacer for Cloud) repository 복제**
    ```sh
    sudo service docker start
    ```

    ```sh
    git clone https://github.com/aws-deepracer-community/deepracer-for-cloud
    ```

    ```sh
    cd deepracer-for-cloud
    ```

4. **Docker image 및 필요 패키지 설치**
    ```sh
    sudo apt install docker-buildx-plugin
    ```

    ```sh
    sudo bin/init.sh -a gpu -c local
    ```

    ```sh
    sudo reboot -f
    ```

    ```sh
    sudo service docker start
    ```

    ```sh
    sudo chmod 666 /var/run/docker.sock
    ```

5. **AWS 계정 생성 (AWS 스토리지 서비스 사용을 위해 필요)**
    - AWS 스토리지 서비스는 일정 한도 내에서 (1GB) 무료로 이용 가능
    - 학습 완료된 모델, env 파일, 보상함수 파일 저장
    - 이메일 주소 입력 및 이메일 인증
    - 결제수단 등록 (수업은 비용이 발생하지 않도록 진행)

6. **AWS 액세스 키 만들기**
    - 우측 상단 계정 클릭 → 보안 자격 증명 페이지 진입
    - 액세스 키 만들기 선택
    - 루트 액세스 키 생성

7. **minio (local storage) 구성**
    ```sh
    aws configure --profile minio
    ```

    - AWS Access Key ID와 AWS Secret Access Key 각각 입력
    - Default region name, Default output format은 공란으로 생성

